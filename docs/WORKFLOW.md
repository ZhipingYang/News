# AI资讯自动化工作流详解

## 工作流概述

完整的AI资讯自动化分析工作流包含以下阶段：

```
RSS源抓取 → 去重检查 → 可信度评估 → 深度分析生成 → 网站构建 → Git推送
```

**执行时间：** 25-35分钟（全程自动）  
**质量原则：** 宁缺毋滥，只保留高质量资讯（可信度≥0.85）

---

## 第一阶段：RSS源抓取（5-8分钟）

### 资讯来源
- **主要来源**：RSS源订阅（占80%）
- **补充来源**：web_search搜索（占20%）

### 抓取流程
1. 读取 `mcp-server/config/rss-sources.json`
2. 按主题抓取所有RSS源（每个主题5-10个源）
3. 过滤7天内的资讯
4. 过滤可信度<0.85的源
5. 按发布日期排序

### RSS源主题
- **AI编程**：GitHub Blog, OpenAI Blog, JetBrains等8个源
- **生成式AI**：OpenAI, Anthropic, Google AI等10个源
- **AI芯片**：NVIDIA, AMD, Intel等10个源
- **量子计算**：IBM Research, Google Quantum等9个源
- **机器人**：IEEE Spectrum, MIT CSAIL等10个源

### 输出
- 保存至：`mcp-server/data/rss-fetch-YYYY-MM-DD.json`
- 格式：按主题分组的资讯列表

---

## 第二阶段：去重检查（3-5分钟）

### 去重机制
1. **标题相似度检查**：Levenshtein距离算法，阈值80%
2. **关键词重叠检查**：提取关键词，重叠度70% + 标题相似60%
3. **历史对比**：对比最近7天的历史记录

### 去重数据库
- 位置：`mcp-server/data/deduplication.json`
- 保留：最近7天数据
- 自动清理：每次运行时清理过期数据

### 处理策略
- **重复资讯**：跳过，记录原因和相似项
- **唯一资讯**：进入下一阶段
- **边界情况**：相似度70-80%，人工审核标记

### 自动化工具
使用 `mcp-server/tools/process-rss-data.js` 可以自动执行去重和评估：
```bash
cd mcp-server
node tools/process-rss-data.js data/rss-fetch-YYYY-MM-DD.json 0.85
```

**功能：**
- 自动去重检查
- 自动可信度评估
- 按日期分组结果
- 保存处理结果到 `data/processed-rss-YYYY-MM-DD.json`

---

## 第三阶段：可信度评估（2-3分钟）

### 评估标准（可信度≥0.85才接受）

**评估维度：**
1. **来源可信度**（40%）
   - 官方网站：0.95
   - 技术媒体：0.85-0.9
   - 学术期刊：0.95
   - 公司博客：0.85-0.9

2. **内容完整性**（25%）
   - 必须包含：技术细节、关键数据、引用来源
   - 最小长度：300字
   - 数据点数量：至少3个

3. **时效性**（15%）
   - 7天内：1.0分
   - 7-14天：0.8分
   - 14天以上：0.5分

4. **内容质量**（20%）
   - 逻辑清晰：有完整论证
   - 无夸大宣传：避免"revolutionary"等过度词汇
   - 技术深度：包含技术细节和数据

### 红旗检测（扣分项）
- 过度炒作词汇（-0.1分）
- 缺少技术细节（-0.15分）
- 无来源引用（-0.2分）
- 标题党模式（-0.15分）

### 筛选结果
- **可信度≥0.85**：进入深度分析
- **可信度0.75-0.85**：标注来源警告
- **可信度<0.75**：丢弃，记录原因

---

## 第四阶段：深度分析生成（15-20分钟）

### 分析框架（遵循AI-ANALYSIS-GUIDE.md）

**文章结构（1500-2000字）：**
1. 📰 新闻背景（150字）
2. ⚙️ 技术深度解析（400-500字）
3. 🏭 行业应用与生态影响（350-400字）
4. 💹 市场格局与商业逻辑（400-450字）
5. 🌐 战略意义与未来推演（400-450字）
6. ✅ 核心洞察与行动建议（200-250字）

### 使用模板（templates.md）
- AI编程模板：侧重技术现状、开发者工具、代码示例
- 生成式AI模板：侧重模型能力、应用场景、商业模式
- AI芯片模板：侧重技术突破、性能指标、市场影响
- 量子计算模板：侧重科学突破、应用前景、技术挑战
- 机器人模板：侧重技术能力、应用场景、商业价值

### 质量要求
- ✅ 数据支撑：性能指标、市场规模、对比表格
- ✅ 非共识洞察：不是显而易见的结论
- ✅ 可操作建议：分受众（企业/投资者/从业者/政府）
- ✅ 来源链接：注明所有数据来源

---

## 第五阶段：文件保存与网站构建（2-3分钟）

### 文件保存
- 目录：`YYYY-MM-DD/`
- 文件：
  - `ai-programming.md`
  - `generative-ai.md`
  - `ai-chips.md`
  - `quantum-computing.md`
  - `robotics.md`
- 如某主题无高质量资讯，文件中标注说明原因

### 网站构建
```bash
npm run build
```

**生成内容：**
- `docs/index.html` - 首页索引
- `docs/YYYY-MM-DD.html` - 每日汇总
- `docs/news/YYYY-MM-DD/*.html` - 各资讯详情页

---

## 第六阶段：Git提交与推送（1-2分钟）

### 自动提交
```bash
git add .
git commit -m "Add AI news analysis for YYYY-MM-DD..."
```

### 自动推送（使用GitHub CLI）
```bash
gh repo set-default your-username/News
git push origin master
```

**Fallback方案（如果GitHub CLI未安装）：**
- 使用 `.env` 中的 `GITHUB_TOKEN`
- 或提示用户手动推送

### 成功标志
- ✅ 本地提交成功
- ✅ 推送到GitHub成功
- 🌐 网站在2-3分钟后自动更新

---

## 质量保证检查点

### 第一阶段检查点
- [ ] RSS源抓取成功（每个主题至少5条）
- [ ] 资讯时效性在7天内
- [ ] 所有源可信度≥0.85

### 第二阶段检查点
- [ ] 去重检查完成
- [ ] 重复资讯已移除
- [ ] 去重日志已记录

### 第三阶段检查点
- [ ] 所有资讯可信度≥0.85
- [ ] 低质量资讯已过滤
- [ ] 评估报告已生成

### 第四阶段检查点
- [ ] 每篇分析1500-2000字
- [ ] 包含数据支撑和对比表格
- [ ] 包含非共识洞察
- [ ] 包含分受众行动建议

### 第五阶段检查点
- [ ] 所有markdown文件已保存
- [ ] 静态网站已生成
- [ ] 网站链接正常

### 第六阶段检查点
- [ ] Git提交成功
- [ ] 推送到GitHub成功
- [ ] 无冲突错误

---

## 故障排查

**RSS抓取失败：**
- 检查网络连接
- 检查RSS源是否有效（手动访问测试）
- 查看错误日志

**去重误判：**
- 调整相似度阈值（默认0.8）
- 检查去重数据库完整性
- 手动审核边界情况

**质量评估过严：**
- 检查可信度阈值（默认0.85）
- 查看评估日志
- 必要时降低阈值至0.8

**深度分析质量不足：**
- 检查AI-ANALYSIS-GUIDE.md是否最新
- 确保使用正确的模板
- 增加上下文信息

**Git推送失败：**
- 检查GitHub CLI是否已安装和登录
- 检查 `.env` 中的 `GITHUB_TOKEN`
- 手动执行 `git push`

---

## 手动执行步骤（备选）

如需手动控制，可分步执行：

```bash
# 1. RSS抓取
cd mcp-server
node tools/fetch-rss.js all

# 2. 去重和评估（可选，使用自动化工具）
node tools/process-rss-data.js data/rss-fetch-YYYY-MM-DD.json 0.85

# 3. 查看抓取结果
cat data/rss-fetch-YYYY-MM-DD.json

# 4. 查看处理结果（如果使用了process-rss-data.js）
cat data/processed-rss-YYYY-MM-DD.json

# 5. 在Cursor Chat中请求分析
@WORKFLOW.md 请根据RSS抓取结果生成今日分析

# 6. 构建网站
npm run build

# 7. 提交推送
./scripts/auto-push.sh
```

### 工具说明

**`mcp-server/tools/process-rss-data.js`** - RSS数据处理工具
- **功能**：整合去重检查和可信度评估流程
- **用法**：`node tools/process-rss-data.js <rss文件路径> [可信度阈值]`
- **参数**：
  - `rss文件路径`：RSS抓取结果文件（如 `data/rss-fetch-2025-11-07.json`）
  - `可信度阈值`：可选，默认0.85
- **输出**：`data/processed-rss-YYYY-MM-DD.json`（包含去重和评估结果）
- **优势**：自动化处理，减少手动步骤，提供详细的处理统计

---

## 持续优化

### 每周
- 检查RSS源有效性
- 审查去重准确率
- 优化质量评估标准

### 每月
- 更新RSS源列表
- 调整可信度阈值
- 优化分析模板

### 每季度
- 评估整体质量
- 添加新资讯源
- 更新分析框架

